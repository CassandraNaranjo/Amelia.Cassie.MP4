---
title: "Mini Project 4"
author: "Amelia Stapleton and Cassie Naranjo"
date: "4/30/2019"
output: 
  html_document:
    code_folding: hide
---

```{r, include = FALSE, echo = FALSE}
library(tidyverse)
library(ggplot2)
library(ggthemes)
library(RColorBrewer)
library(RMySQL)
library(ggthemes)
db <- dbConnect(MySQL(), 
                host = "scidb.smith.edu", 
                user = "mth292", 
                password = "RememberPi", 
                dbname = "imdb")
knitr::opts_chunk$set(connection = db, max.print = 20)
```

#avengers
```{sql, connection = db, output.var = "avengers"} 
SELECT title.id, title.title, title.production_year, COUNT(cast_info.person_id) as N, name.gender, ((count(cast_info.person_id))/296)*100 as ratio
from title
join cast_info
on title.id = cast_info.movie_id
join name
on cast_info.person_id = name.id
where cast_info.movie_id like '3313672'and name.gender IS NOT NULL
group by name.gender; 
```


#age of ultron
```{sql, connection = db, output.var = "age_of_ultron"}
SELECT title.id, title.title, title.production_year, COUNT(cast_info.person_id) as N, name.gender, ((count(cast_info.person_id))/290)*100 as ratio
from title
join cast_info
on title.id = cast_info.movie_id
join name
on cast_info.person_id = name.id
where cast_info.movie_id like '3313672'and name.gender IS NOT NULL
group by name.gender;
```

#infinty war
```{sql, connection = db, output.var = "infinity_war"} 
SELECT title.id, title.title, title.production_year, COUNT(cast_info.person_id) as N, name.gender, ((count(cast_info.person_id))/115)*100 as ratio
from title
join cast_info
on title.id = cast_info.movie_id
join name
on cast_info.person_id = name.id
where cast_info.movie_id like '3313680'and name.gender IS NOT NULL
group by name.gender; 
```

```{sql}
SELECT title.id, title.title, title.production_year, COUNT(cast_info.person_id) as N, name.gender, ((count(cast_info.person_id))/115)*100 as ratio
from title
join cast_info
on title.id = cast_info.movie_id
join name
on cast_info.person_id = name.id
where cast_info.movie_id like '3313680'and name.gender IS NOT NULL
group by name.gender; 
```

#Avengers ggplot
```{r}
ggplot(data = avengers, aes(x = title, y = ratio)) +
  geom_bar(color = "gold", stat = "identity", aes(fill = gender)) +
  labs(title = "The Avengers", subtitle = "Production Year: 2012", y = "Ratio of Total Actors", x = "Film") + 
  scale_fill_manual(values = c('#e31a1c', '#0c2c84'), labels = c("Female Cast", "Male Cast")) + 
  theme(legend.title = element_blank())
```

 scale_fill_manual(values = c("#9ecae1", "#fc9272", "#3182bd", "#de2d26"), name = "Condition", labels = c("Democratic Nonwinner", "Republican Nonwinner", "Democratic Winner", "Republican Winner"))+
Red color: #e31a1c
blue color: #0c2c84
 
#Infinity War ggplot
```{r}
ggplot(data = infinity_war, aes(x = gender, y = ratio)) +
  geom_bar(stat = "identity", aes(fill = gender)) +
  labs(title = "Avengers: Infinity War", subtitle = "Production Year: 2018", y = "Ratio of Total Actors", x = "Gender")
```

#Age of ultron ggplot
```{r}
ggplot(data = age_of_ultron, aes(x = gender, y = ratio)) +
  geom_bar(stat = "identity", aes(fill = gender)) +
  labs(title = "Avengers: Age of Ultron War", subtitle = "Production Year: 2015", y = "Ratio of Total Actors", x = "Gender")
```


Notes:
 revenue 
 movie info 
 kind info type = 107 
 use db get query to get ggplot 
 last slide 
 collect 
 
 cast info 
 nr order 
 order names appear 
 
 look at if femals are playing more main role 
 
 look at box office numbers for endgame 
 talk about how most marvel movies have male leads 
